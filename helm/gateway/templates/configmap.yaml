apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "gateway.configMapName" . }}
  labels:
    {{- include "gateway.labels" . | nindent 4 }}
data:
  devices.yaml: |
    # Device Routing Table - Generated by Helm
    devices:
      {{- range $name, $device := .Values.devices.entries }}
      {{ $name }}:
        hostname: {{ $device.hostname | quote }}
        ssh_port: {{ $device.sshPort | default 22 }}
        telnet_port: {{ $device.telnetPort | default 23 }}
        netconf_port: {{ $device.netconfPort | default 830 }}
        gnmi_port: {{ $device.gnmiPort | default 57400 }}
        {{- if $device.description }}
        description: {{ $device.description | quote }}
        {{- end }}
        {{- if $device.location }}
        location: {{ $device.location | quote }}
        {{- end }}
      {{- end }}

    settings:
      domain_suffix: {{ .Values.devices.domainSuffix | quote }}
      default_timeout: {{ .Values.devices.defaultTimeout }}
      max_sessions: {{ .Values.devices.maxSessions }}
      log_level: {{ .Values.gateway.logLevel | quote }}
